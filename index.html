
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple Contest — 2hr</title>
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --accent:#6ee7b7;
      --muted:#94a3b8;
      --glass: rgba(255,255,255,0.04);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      background:linear-gradient(180deg,#081025 0%, #07192a 100%);
      color:#e6eef6;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:28px;
    }
    .container{
      max-width:1000px;
      margin:0 auto;
    }
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      margin-bottom:18px;
    }
    header h1{
      font-size:20px;
      margin:0;
      letter-spacing:0.2px;
    }
    header .meta{color:var(--muted); font-size:13px;}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      padding:18px;
      border-radius:12px;
      box-shadow:0 6px 18px rgba(2,6,23,0.6);
    }
    .topbar{
      display:flex;
      gap:12px;
      align-items:center;
      flex-wrap:wrap;
    }
    .btn{
      background:var(--accent);
      color:#022;
      font-weight:600;
      padding:8px 12px;
      border-radius:10px;
      border:0;
      cursor:pointer;
      box-shadow:0 6px 14px rgba(110,231,183,0.12);
    }
    .btn.ghost{
      background:transparent;
      color:var(--accent);
      border:1px solid rgba(110,231,183,0.12);
      box-shadow:none;
    }
    .timer{
      font-weight:700;
      font-size:18px;
      padding:8px 12px;
      border-radius:10px;
      background:var(--glass);
      color:var(--accent);
      min-width:160px;
      text-align:center;
    }
    .problems{
      margin-top:14px;
      display:grid;
      gap:10px;
    }
    .prob{
      display:flex;
      align-items:center;
      gap:12px;
      padding:12px;
      border-radius:10px;
      background:linear-gradient(90deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.02);
    }
    .prob .left{
      flex:1;
      min-width:0;
    }
    .prob a{
      color:#e6f9f0;
      text-decoration:none;
      font-weight:600;
      display:inline-block;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width:80%;
    }
    .prob small{ display:block; color:var(--muted); font-size:13px; margin-top:4px;}
    .prob .actions{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .mark-btn{
      background:transparent;
      border:1px solid rgba(255,255,255,0.04);
      color:var(--muted);
      padding:6px 8px;
      border-radius:8px;
      cursor:pointer;
      min-width:88px;
    }
    .mark-btn.done{
      background:rgba(110,231,183,0.12);
      border-color:rgba(110,231,183,0.18);
      color:var(--accent);
      font-weight:600;
    }
    .progress{
      margin-top:12px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .progress .bar{
      height:10px;
      background:rgba(255,255,255,0.03);
      flex:1;
      border-radius:999px;
      overflow:hidden;
    }
    .progress .bar > i{
      display:block;
      width:0%;
      height:100%;
      background:linear-gradient(90deg, rgba(110,231,183,0.12), rgba(110,231,183,0.22));
    }
    .muted{
      color:var(--muted);
      font-size:13px;
    }
    .notice{
      margin-top:12px;
      padding:10px;
      border-radius:8px;
      background:rgba(255,255,255,0.02);
      color:var(--muted);
      font-size:13px;
    }
    footer{
      margin-top:18px;
      display:flex;
      justify-content:space-between;
      gap:12px;
      align-items:center;
      color:var(--muted);
      font-size:13px;
    }
    .small{
      font-size:12px;
      color:var(--muted)
    }

    /* responsive */
    @media (max-width:640px){
      header{flex-direction:column; align-items:flex-start; gap:8px}
      .timer{min-width:unset}
      .prob a{max-width:100%}
    }

  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Simple Contest — 2 hour fixed</h1>
        <div class="meta">Edit the problems list in the source (see JS) — each user gets 2 hours when they press Start.</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <div id="timer" class="timer">Not started</div>
        <button id="startBtn" class="btn">Start Contest</button>
        <button id="resetBtn" class="btn ghost" title="Reset local progress (for testing)">Reset</button>
      </div>
    </header>

    <div class="card">
      <div class="topbar">
        <div style="flex:1">
          <div class="muted">Problems (edit `PROBLEMS` array in the file)</div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <div class="muted">Solved: <strong id="solvedCount">0</strong>/<span id="totalCount">0</span></div>
          <button id="copyLink" class="btn ghost" title="Copy page link">Copy link</button>
        </div>
      </div>

      <div class="problems" id="problemsList" aria-live="polite" style="margin-top:12px">
        <!-- problems inserted here -->
      </div>

      <div class="progress">
        <div class="bar" aria-hidden="true"><i id="progressFill" style="width:0%"></i></div>
        <div class="small" id="percentText">0%</div>
      </div>

      <div class="notice" id="notice">
        This is a static single-file contest page. Mark problems as done as you solve them. When your 2-hour timer ends the page will lock.
      </div>
    </div>

    <footer>
      <div class="small">Tip: open problems in new tabs, solve there, then mark them done here.</div>
      <div class="small">Hosted static. Local progress stored only in your browser (<code>localStorage</code>).</div>
    </footer>
  </div>

<script>
/*
  === EDIT THIS LIST ===
  Add or remove problems in this array. Each item: { name: "Name", url: "https://..." }
  Only change the array below to set contest problems.
*/
const PROBLEMS = [
  { name: "A - Example Problem 1", url: "https://codeforces.com/problemset/problem/1/A" },
  { name: "B - Example Problem 2", url: "https://codeforces.com/problemset/problem/2/A" },
  { name: "C - Example Problem 3", url: "https://codeforces.com/problemset/problem/3/A" }
];
/* === end editable list === */

const CONTEST_DURATION_MS = 2 * 60 * 60 * 1000; // 2 hours in ms
const STORAGE_PREFIX = "simple_contest_v1_";
const KEY_START = STORAGE_PREFIX + "start_ts";
const KEY_MARKS = STORAGE_PREFIX + "marks"; // JSON object { idx: true }

const el = {
  timer: document.getElementById('timer'),
  startBtn: document.getElementById('startBtn'),
  resetBtn: document.getElementById('resetBtn'),
  problemsList: document.getElementById('problemsList'),
  solvedCount: document.getElementById('solvedCount'),
  totalCount: document.getElementById('totalCount'),
  progressFill: document.getElementById('progressFill'),
  percentText: document.getElementById('percentText'),
  notice: document.getElementById('notice'),
  copyLink: document.getElementById('copyLink')
};

let startTs = loadStartTs();
let marks = loadMarks();

function loadStartTs(){
  const v = localStorage.getItem(KEY_START);
  return v ? parseInt(v,10) : null;
}
function saveStartTs(ts){
  if(ts==null) localStorage.removeItem(KEY_START);
  else localStorage.setItem(KEY_START, String(ts));
  startTs = ts;
}
function loadMarks(){
  try{
    const v = localStorage.getItem(KEY_MARKS);
    return v ? JSON.parse(v) : {};
  }catch(e){ return {}; }
}
function saveMarks(m){
  localStorage.setItem(KEY_MARKS, JSON.stringify(m));
  marks = m;
}

function renderProblems(){
  el.problemsList.innerHTML = '';
  PROBLEMS.forEach((p, idx) => {
    const row = document.createElement('div');
    row.className = 'prob';
    row.dataset.idx = idx;
    const left = document.createElement('div');
    left.className = 'left';
    const a = document.createElement('a');
    a.href = p.url;
    a.target = '_blank';
    a.rel = 'noopener noreferrer';
    a.textContent = p.name;
    const small = document.createElement('small');
    small.textContent = p.url;
    left.appendChild(a);
    left.appendChild(small);

    const actions = document.createElement('div');
    actions.className = 'actions';

    const markBtn = document.createElement('button');
    markBtn.className = 'mark-btn';
    markBtn.textContent = 'Mark as done';
    markBtn.title = 'Mark this problem as done';
    markBtn.addEventListener('click', () => toggleMark(idx));
    actions.appendChild(markBtn);

    row.appendChild(left);
    row.appendChild(actions);
    el.problemsList.appendChild(row);

    updateRowVisual(idx);
  });
  el.totalCount.textContent = PROBLEMS.length;
  updateProgress();
}

function updateRowVisual(idx){
  const row = el.problemsList.querySelector('.prob[data-idx="'+idx+'"]');
  if(!row) return;
  const btn = row.querySelector('.mark-btn');
  if(marks[String(idx)]){
    btn.classList.add('done');
    btn.textContent = 'Done ✓';
    row.querySelector('.left a').style.textDecoration = 'line-through';
    row.querySelector('.left small').style.opacity = '0.6';
  }else{
    btn.classList.remove('done');
    btn.textContent = 'Mark as done';
    row.querySelector('.left a').style.textDecoration = '';
    row.querySelector('.left small').style.opacity = '1';
  }
  // disable button if contest ended
  if(isContestEnded()){
    btn.disabled = true;
    btn.style.cursor = 'not-allowed';
    btn.title = 'Contest finished';
  } else {
    btn.disabled = false;
    btn.style.cursor = 'pointer';
    btn.title = marks[String(idx)] ? 'Unmark as not done' : 'Mark this problem as done';
  }
}

function toggleMark(idx){
  if(isContestEnded()) return;
  const key = String(idx);
  if(marks[key]) delete marks[key];
  else marks[key] = { ts: Date.now() };
  saveMarks(marks);
  updateRowVisual(idx);
  updateProgress();
}

function updateProgress(){
  const solved = Object.keys(marks).length;
  const total = PROBLEMS.length;
  const pct = total===0 ? 0 : Math.round((solved/total)*100);
  el.solvedCount.textContent = solved;
  el.progressFill.style.width = pct + '%';
  el.percentText.textContent = pct + '%';
}

function formatMs(ms){
  if(ms<=0) return '00:00:00';
  const s = Math.floor(ms/1000)%60;
  const m = Math.floor(ms/60000)%60;
  const h = Math.floor(ms/3600000);
  return [h,m,s].map(x=>String(x).padStart(2,'0')).join(':');
}

function isContestStarted(){
  return startTs && !isNaN(startTs);
}
function isContestEnded(){
  if(!isContestStarted()) return false;
  return Date.now() - startTs >= CONTEST_DURATION_MS;
}

function updateTimerUI(){
  if(!isContestStarted()){
    el.timer.textContent = 'Not started';
    el.startBtn.disabled = false;
    el.startBtn.textContent = 'Start Contest';
    return;
  }
  const elapsed = Date.now() - startTs;
  const remaining = CONTEST_DURATION_MS - elapsed;
  if(remaining <= 0){
    el.timer.textContent = '00:00:00 — Finished';
    el.startBtn.disabled = true;
    el.startBtn.textContent = 'Contest ended';
    // lock interface
    document.querySelectorAll('.mark-btn').forEach(b=>{
      b.disabled = true;
      b.style.cursor = 'not-allowed';
    });
    el.notice.textContent = 'Contest finished — your 2 hours are over. Marks are now locked.';
  } else {
    el.timer.textContent = formatMs(remaining) + ' remaining';
    el.startBtn.disabled = true;
    el.startBtn.textContent = 'Contest in progress';
  }
  // update rows (enable/disable)
  PROBLEMS.forEach((_, idx) => updateRowVisual(idx));
}

function handleStart(){
  if(isContestStarted() && !isContestEnded()){
    if(!confirm('A contest is already in progress in this browser. Do you want to restart the timer? (This will reset start time but will not clear solved marks)')) return;
  }
  const ts = Date.now();
  saveStartTs(ts);
  el.notice.textContent = 'Contest started — your 2 hour timer has begun. Good luck!';
  updateTimerUI();
}

function handleReset(){
  if(!confirm('Reset local progress and start time? This clears your marks and timer in this browser.')) return;
  saveStartTs(null);
  saveMarks({});
  el.notice.textContent = 'Local progress cleared. Press Start Contest to begin a new 2-hour run.';
  renderProblems();
  updateTimerUI();
}

function copyLink(){
  navigator.clipboard?.writeText(location.href).then(()=>{
    el.copyLink.textContent = 'Copied!';
    setTimeout(()=> el.copyLink.textContent = 'Copy link', 1200);
  }).catch(()=> {
    alert('Copy failed — select the URL and copy manually.');
  });
}

// initialize UI
el.startBtn.addEventListener('click', handleStart);
el.resetBtn.addEventListener('click', handleReset);
el.copyLink.addEventListener('click', copyLink);

renderProblems();
updateTimerUI();

// start timer interval
setInterval(() => {
  // if contest ended earlier than now, ensure final UI updates
  updateTimerUI();
}, 1000);

/* Notes for deployer:
 - To set problems edit the PROBLEMS array at top.
 - This is intentionally client-side only (no auth, no server). Each user gets a 2-hour session when they press "Start Contest".
 - Progress is stored in the browser's localStorage under keys starting with: "simple_contest_v1_".
 - If you want server-side enforcement (prevent users from resetting localStorage to cheat), you'll need a backend to assign server-side start timestamps and identify users.
*/

</script>
</body>
</html>
